"use strict";(self.webpackChunkmynote=self.webpackChunkmynote||[]).push([[8418],{95972:(I,y,t)=>{t.r(y),t.d(y,{default:()=>oe});var e=t(53547),E=t(88767),M=t(86896),l=t(67281),O=t(14087),P=t(185),h=t(53979),B=t(49066),d=t(81912),a=t(89031);const o=async()=>{const{get:s}=(0,l.getFetchClient)(),{data:i}=await s((0,a.Gc)("email-templates"));return i},v=s=>{const{put:i}=(0,l.getFetchClient)();return i((0,a.Gc)("email-templates"),s)};var C=t(45697),n=t.n(C),R=t(38939),V=t(8060),L=t(79031),c=t(37909),A=t(63237),x=t(75515),z=t(15234),b=t(52624),S=t(12028),Q=t(30815),Z=t(4585),J=t(85018);const $=({canUpdate:s,onEditClick:i})=>{const{formatMessage:r}=(0,M.Z)();return e.createElement(R.i,{colCount:3,rowCount:3},e.createElement(V.h,null,e.createElement(L.Tr,null,e.createElement(c.Th,{width:"1%"},e.createElement(A.T,null,r({id:(0,a.OB)("Email.template.table.icon.label"),defaultMessage:"icon"}))),e.createElement(c.Th,null,e.createElement(x.Z,{variant:"sigma",textColor:"neutral600"},r({id:(0,a.OB)("Email.template.table.name.label"),defaultMessage:"name"}))),e.createElement(c.Th,{width:"1%"},e.createElement(A.T,null,r({id:(0,a.OB)("Email.template.table.action.label"),defaultMessage:"action"}))))),e.createElement(z.p,null,e.createElement(L.Tr,{...(0,l.onRowClick)({fn:()=>i("reset_password")})},e.createElement(c.Td,null,e.createElement(b.J,null,e.createElement(Q.Z,{"aria-label":r({id:"global.reset-password",defaultMessage:"Reset password"})}))),e.createElement(c.Td,null,e.createElement(x.Z,null,r({id:"global.reset-password",defaultMessage:"Reset password"}))),e.createElement(c.Td,{...l.stopPropagation},e.createElement(S.h,{onClick:()=>i("reset_password"),label:r({id:(0,a.OB)("Email.template.form.edit.label"),defaultMessage:"Edit a template"}),noBorder:!0,icon:s&&e.createElement(Z.Z,null)}))),e.createElement(L.Tr,{...(0,l.onRowClick)({fn:()=>i("email_confirmation")})},e.createElement(c.Td,null,e.createElement(b.J,null,e.createElement(J.default,{"aria-label":r({id:(0,a.OB)("Email.template.email_confirmation"),defaultMessage:"Email address confirmation"})}))),e.createElement(c.Td,null,e.createElement(x.Z,null,r({id:(0,a.OB)("Email.template.email_confirmation"),defaultMessage:"Email address confirmation"}))),e.createElement(c.Td,{...l.stopPropagation},e.createElement(S.h,{onClick:()=>i("email_confirmation"),label:r({id:(0,a.OB)("Email.template.form.edit.label"),defaultMessage:"Edit a template"}),noBorder:!0,icon:s&&e.createElement(Z.Z,null)})))))};$.propTypes={canUpdate:n().bool.isRequired,onEditClick:n().func.isRequired};const X=$;var Y=t(94649),k=t(42866),w=t(24969),F=t(2407),q=t(59946),_=t(11276),j=t(67819),ee=t(61467),te=t(36856),G=t(29728),p=t(87561);const ae=p.object().shape({options:p.object().shape({from:p.object().shape({name:p.string().required(l.translatedErrors.required),email:p.string().email(l.translatedErrors.email).required(l.translatedErrors.required)}).required(),response_email:p.string().email(l.translatedErrors.email),object:p.string().required(l.translatedErrors.required),message:p.string().required(l.translatedErrors.required)}).required(l.translatedErrors.required)}),N=({template:s,onToggle:i,onSubmit:r})=>{const{formatMessage:m}=(0,M.Z)();return e.createElement(k.P,{onClose:i,labelledBy:`${m({id:(0,a.OB)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})}, ${m({id:(0,a.OB)(s.display),defaultMessage:s.display})}`},e.createElement(w.x,null,e.createElement(F.O,{label:`${m({id:(0,a.OB)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})}, ${m({id:(0,a.OB)(s.display),defaultMessage:s.display})}`},e.createElement(F.$,null,m({id:(0,a.OB)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})),e.createElement(F.$,null,m({id:(0,a.OB)(s.display),defaultMessage:s.display})))),e.createElement(Y.Formik,{onSubmit:r,initialValues:s,validateOnChange:!1,validationSchema:ae,enableReinitialize:!0},({errors:u,values:g,handleChange:f,isSubmitting:U})=>e.createElement(l.Form,null,e.createElement(q.f,null,e.createElement(_.r,{gap:5},e.createElement(j.P,{col:6,s:12},e.createElement(l.GenericInput,{intlLabel:{id:(0,a.OB)("PopUpForm.Email.options.from.name.label"),defaultMessage:"Shipper name"},name:"options.from.name",onChange:f,value:g.options.from.name,error:u?.options?.from?.name,type:"text"})),e.createElement(j.P,{col:6,s:12},e.createElement(l.GenericInput,{intlLabel:{id:(0,a.OB)("PopUpForm.Email.options.from.email.label"),defaultMessage:"Shipper email"},name:"options.from.email",onChange:f,value:g.options.from.email,error:u?.options?.from?.email,type:"text"})),e.createElement(j.P,{col:6,s:12},e.createElement(l.GenericInput,{intlLabel:{id:(0,a.OB)("PopUpForm.Email.options.response_email.label"),defaultMessage:"Response email"},name:"options.response_email",onChange:f,value:g.options.response_email,error:u?.options?.response_email,type:"text"})),e.createElement(j.P,{col:6,s:12},e.createElement(l.GenericInput,{intlLabel:{id:(0,a.OB)("PopUpForm.Email.options.object.label"),defaultMessage:"Subject"},name:"options.object",onChange:f,value:g.options.object,error:u?.options?.object,type:"text"})),e.createElement(j.P,{col:12,s:12},e.createElement(ee.g,{label:m({id:(0,a.OB)("PopUpForm.Email.options.message.label"),defaultMessage:"Message"}),id:"options.message",onChange:f,value:g.options.message,error:u?.options?.message&&m({id:u.options.message,defaultMessage:u.options.message})})))),e.createElement(te.m,{startActions:e.createElement(G.z,{onClick:i,variant:"tertiary"},"Cancel"),endActions:e.createElement(G.z,{loading:U,type:"submit"},"Finish")}))))};N.propTypes={template:n().shape({display:n().string,icon:n().string,options:n().shape({from:n().shape({name:n().string,email:n().string}),message:n().string,object:n().string,response_email:n().string})}).isRequired,onSubmit:n().func.isRequired,onToggle:n().func.isRequired};const le=N,se=()=>e.createElement(l.CheckPagePermissions,{permissions:d.Z.readEmailTemplates},e.createElement(ne,null)),ne=()=>{const{formatMessage:s}=(0,M.Z)(),{trackUsage:i}=(0,l.useTracking)(),{notifyStatus:r}=(0,O.G)(),m=(0,l.useNotification)(),{lockApp:u,unlockApp:g}=(0,l.useOverlayBlocker)(),f=(0,e.useRef)(i),U=(0,E.useQueryClient)();(0,l.useFocusWhenNavigate)();const[ie,re]=(0,e.useState)(!1),[H,me]=(0,e.useState)(null),de=(0,e.useMemo)(()=>({update:d.Z.updateEmailTemplates}),[]),{isLoading:ce,allowedActions:{canUpdate:ue}}=(0,l.useRBAC)(de),{status:Ee,data:W}=(0,E.useQuery)("email-templates",()=>o(),{onSuccess(){r(s({id:(0,a.OB)("Email.template.data.loaded"),defaultMessage:"Email templates has been loaded"}))},onError(){m({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),pe=ce||Ee!=="success",D=()=>{re(T=>!T)},ge=T=>{me(T),D()},K=(0,E.useMutation)(T=>v({"email-templates":T}),{async onSuccess(){await U.invalidateQueries("email-templates"),m({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}}),f.current("didEditEmailTemplates"),g(),D()},onError(){m({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}}),g()},refetchActive:!0}),{isLoading:fe}=K,he=T=>{u(),f.current("willEditEmailTemplates");const ve={...W,[H]:T};K.mutate(ve)};return pe?e.createElement(P.o,{"aria-busy":"true"},e.createElement(l.SettingsPageTitle,{name:s({id:(0,a.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(h.T,{title:s({id:(0,a.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(B.D,null,e.createElement(l.LoadingIndicatorPage,null))):e.createElement(P.o,{"aria-busy":fe},e.createElement(l.SettingsPageTitle,{name:s({id:(0,a.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(h.T,{title:s({id:(0,a.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(B.D,null,e.createElement(X,{onEditClick:ge,canUpdate:ue}),ie&&e.createElement(le,{template:W[H],onToggle:D,onSubmit:he})))},oe=se},89031:(I,y,t)=>{t.d(y,{YX:()=>l,Gc:()=>h,OB:()=>B.Z});var e=t(41609),E=t.n(e);const l=d=>Object.keys(d).reduce((a,o)=>{const v=d[o].controllers,C=Object.keys(v).reduce((n,R)=>(E()(v[R])||(n[R]=v[R]),n),{});return E()(C)||(a[o]={controllers:C}),a},{});var O=t(31498);const h=d=>`/${O.Z}/${d}`;var B=t(84757)},2407:(I,y,t)=>{t.d(y,{$:()=>d,O:()=>a});var e=t(85893),E=t(16405),M=t(54863),l=t(63237),O=t(11047),P=t(41580),h=t(75515);const B=(0,M.default)(O.k)`
  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
    path {
      fill: ${({theme:o})=>o.colors.neutral500};
    }
  }
  :last-of-type ${P.x} {
    display: none;
  }
  :last-of-type ${h.Z} {
    color: ${({theme:o})=>o.colors.neutral800};
    font-weight: ${({theme:o})=>o.fontWeights.bold};
  }
`,d=({children:o})=>(0,e.jsxs)(B,{inline:!0,as:"li",children:[(0,e.jsx)(h.Z,{variant:"pi",textColor:"neutral600",children:o}),(0,e.jsx)(P.x,{"aria-hidden":!0,paddingLeft:3,paddingRight:3,children:(0,e.jsx)(E.Z,{})})]});d.displayName="Crumb";const a=({children:o,label:v,...C})=>(0,e.jsxs)(O.k,{...C,children:[(0,e.jsx)(l.T,{children:v}),(0,e.jsx)("ol",{"aria-hidden":!0,children:o})]});a.displayName="Breadcrumbs"}}]);

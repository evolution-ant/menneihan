(self.webpackChunkmynote=self.webpackChunkmynote||[]).push([[2282],{8971:(v,y,e)=>{"use strict";e.r(y),e.d(y,{ProvidersPage:()=>de,default:()=>Fe});var t=e(53547),l=e(86896),n=e(67281),s=e(18721),i=e.n(s),d=e(11700),r=e.n(d),c=e(14087),g=e(17034),h=e(185),u=e(53979),f=e(49066),j=e(38939),D=e(8060),A=e(79031),b=e(37909),B=e(75515),ee=e(63237),K=e(15234),G=e(12028),me=e(4585),V=e(88767),o=e(87561),E=e(89031);const te={id:(0,E.OB)("PopUpForm.Providers.redirectURL.front-end.label"),defaultMessage:"The redirect URL to your front-end app"},ne={id:"http://www.client-app.com",defaultMessage:"http://www.client-app.com"},I={id:(0,E.OB)("PopUpForm.Providers.enabled.description"),defaultMessage:"If disabled, users won't be able to use this provider."},Q={id:(0,E.OB)("PopUpForm.Providers.enabled.label"),defaultMessage:"Enable"},re={id:(0,E.OB)("PopUpForm.Providers.key.label"),defaultMessage:"Client ID"},ae={id:(0,E.OB)("PopUpForm.Providers.redirectURL.label"),defaultMessage:"The redirect URL to add in your {provider} application configurations"},W={id:(0,E.OB)("PopUpForm.Providers.key.placeholder"),defaultMessage:"TEXT"},se={id:(0,E.OB)("PopUpForm.Providers.secret.label"),defaultMessage:"Client Secret"},X={email:{form:[[{intlLabel:Q,name:"enabled",type:"bool",description:I,size:6}]],schema:o.object().shape({enabled:o.bool().required(n.translatedErrors.required)})},providers:{form:[[{intlLabel:Q,name:"enabled",type:"bool",description:I,size:6,validations:{required:!0}}],[{intlLabel:re,name:"key",type:"text",placeholder:W,size:12,validations:{required:!0}}],[{intlLabel:se,name:"secret",type:"text",placeholder:W,size:12,validations:{required:!0}}],[{intlLabel:te,placeholder:ne,name:"callback",type:"text",size:12,validations:{required:!0}}],[{intlLabel:ae,name:"noName",type:"text",validations:{},size:12,disabled:!0}]],schema:o.object().shape({enabled:o.bool().required(n.translatedErrors.required),key:o.string().when("enabled",{is:!0,then:o.string().required(n.translatedErrors.required),otherwise:o.string()}),secret:o.string().when("enabled",{is:!0,then:o.string().required(n.translatedErrors.required),otherwise:o.string()}),callback:o.string().when("enabled",{is:!0,then:o.string().required(n.translatedErrors.required),otherwise:o.string()})})},providersWithSubdomain:{form:[[{intlLabel:Q,name:"enabled",type:"bool",description:I,size:6,validations:{required:!0}}],[{intlLabel:re,name:"key",type:"text",placeholder:W,size:12,validations:{required:!0}}],[{intlLabel:se,name:"secret",type:"text",placeholder:W,size:12,validations:{required:!0}}],[{intlLabel:{id:(0,E.OB)({id:"PopUpForm.Providers.jwksurl.label"}),defaultMessage:"JWKS URL"},name:"jwksurl",type:"text",placeholder:W,size:12,validations:{required:!1}}],[{intlLabel:{id:(0,E.OB)("PopUpForm.Providers.subdomain.label"),defaultMessage:"Host URI (Subdomain)"},name:"subdomain",type:"text",placeholder:{id:(0,E.OB)("PopUpForm.Providers.subdomain.placeholder"),defaultMessage:"my.subdomain.com"},size:12,validations:{required:!0}}],[{intlLabel:te,placeholder:ne,name:"callback",type:"text",size:12,validations:{required:!0}}],[{intlLabel:ae,name:"noName",type:"text",validations:{},size:12,disabled:!0}]],schema:o.object().shape({enabled:o.bool().required(n.translatedErrors.required),key:o.string().when("enabled",{is:!0,then:o.string().required(n.translatedErrors.required),otherwise:o.string()}),secret:o.string().when("enabled",{is:!0,then:o.string().required(n.translatedErrors.required),otherwise:o.string()}),subdomain:o.string().when("enabled",{is:!0,then:o.string().required(n.translatedErrors.required),otherwise:o.string()}),callback:o.string().when("enabled",{is:!0,then:o.string().required(n.translatedErrors.required),otherwise:o.string()})})}},ge=async m=>{try{const{get:P}=(0,n.getFetchClient)(),{data:O}=await P((0,E.Gc)("providers"));return O}catch{throw m({type:"warning",message:{id:"notification.error"}}),new Error("error")}},fe=m=>{const{put:P}=(0,n.getFetchClient)();return P((0,E.Gc)("providers"),m)};var pe=e(89734),ve=e.n(pe);const he=m=>ve()(Object.keys(m).reduce((P,O)=>{const{icon:T,enabled:x,subdomain:U}=m[O],L=T==="envelope"?["fas","envelope"]:["fab",T];return U!==void 0?P.push({name:O,icon:L,enabled:x,subdomain:U}):P.push({name:O,icon:L,enabled:x}),P},[]),"name");var ie=e(81912),Ee=e(42866),be=e(24969),oe=e(2407),ye=e(59946),Pe=e(11047),Me=e(11276),xe=e(67819),Oe=e(36856),le=e(29728),Le=e(45697),a=e.n(Le),Te=e(94649),Be=e(20707),Ce=e(16364);const J=({description:m,disabled:P,intlLabel:O,error:T,name:x,onChange:U,placeholder:L,providerToEditName:S,type:F,value:p})=>{const{formatMessage:C}=(0,l.Z)(),z=x==="noName"?`${window.strapi.backendURL}/api/connect/${S}/callback`:p,Z=C({id:O.id,defaultMessage:O.defaultMessage},{provider:S,...O.values}),R=m?C({id:m.id,defaultMessage:m.defaultMessage},{provider:S,...m.values}):"";if(F==="bool")return t.createElement(Be.s,{"aria-label":x,checked:p,disabled:P,hint:R,label:Z,name:x,offLabel:C({id:"app.components.ToggleCheckbox.off-label",defaultMessage:"Off"}),onLabel:C({id:"app.components.ToggleCheckbox.on-label",defaultMessage:"On"}),onChange:$=>{U({target:{name:x,value:$.target.checked}})}});const k=L?C({id:L.id,defaultMessage:L.defaultMessage},{...L.values}):"",w=T?C({id:T,defaultMessage:T}):"";return t.createElement(Ce.o,{"aria-label":x,disabled:P,error:w,label:Z,name:x,onChange:U,placeholder:k,type:F,value:z})};J.defaultProps={description:null,disabled:!1,error:"",placeholder:null,value:""},J.propTypes={description:a().shape({id:a().string.isRequired,defaultMessage:a().string.isRequired,values:a().object}),disabled:a().bool,error:a().string,intlLabel:a().shape({id:a().string.isRequired,defaultMessage:a().string.isRequired,values:a().object}).isRequired,name:a().string.isRequired,onChange:a().func.isRequired,placeholder:a().shape({id:a().string.isRequired,defaultMessage:a().string.isRequired,values:a().object}),providerToEditName:a().string.isRequired,type:a().string.isRequired,value:a().oneOfType([a().bool,a().string])};const Re=J,Y=({headerBreadcrumbs:m,initialData:P,isSubmiting:O,layout:T,isOpen:x,onSubmit:U,onToggle:L,providerToEditName:S})=>{const{formatMessage:F}=(0,l.Z)();return x?t.createElement(Ee.P,{onClose:L,labelledBy:"title"},t.createElement(be.x,null,t.createElement(oe.O,{label:m.join(", ")},m.map(p=>t.createElement(oe.$,{key:p},p)))),t.createElement(Te.Formik,{onSubmit:p=>U(p),initialValues:P,validationSchema:T.schema,validateOnChange:!1},({errors:p,handleChange:C,values:z})=>t.createElement(n.Form,null,t.createElement(ye.f,null,t.createElement(Pe.k,{direction:"column",alignItems:"stretch",gap:1},t.createElement(Me.r,{gap:5},T.form.map(Z=>Z.map(R=>t.createElement(xe.P,{key:R.name,col:R.size,xs:12},t.createElement(Re,{...R,error:p[R.name],onChange:C,value:z[R.name],providerToEditName:S}))))))),t.createElement(Oe.m,{startActions:t.createElement(le.z,{variant:"tertiary",onClick:L,type:"button"},F({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:t.createElement(le.z,{type:"submit",loading:O},F({id:"global.save",defaultMessage:"Save"}))})))):null};Y.defaultProps={initialData:null,providerToEditName:null},Y.propTypes={headerBreadcrumbs:a().arrayOf(a().string).isRequired,initialData:a().object,layout:a().shape({form:a().arrayOf(a().array),schema:a().object}).isRequired,isOpen:a().bool.isRequired,isSubmiting:a().bool.isRequired,onSubmit:a().func.isRequired,onToggle:a().func.isRequired,providerToEditName:a().string};const Ue=Y,de=()=>{const{formatMessage:m}=(0,l.Z)();(0,n.useFocusWhenNavigate)();const{notifyStatus:P}=(0,c.G)(),O=(0,V.useQueryClient)(),{trackUsage:T}=(0,n.useTracking)(),x=(0,t.useRef)(T),[U,L]=(0,t.useState)(!1),[S,F]=(0,t.useState)(!1),[p,C]=(0,t.useState)(null),z=(0,n.useNotification)(),{lockApp:Z,unlockApp:R}=(0,n.useOverlayBlocker)(),k=(0,t.useMemo)(()=>({update:ie.Z.updateProviders}),[]),{isLoading:w,allowedActions:{canUpdate:$}}=(0,n.useRBAC)(k),{isLoading:je,data:N,isFetching:Ae}=(0,V.useQuery)("get-providers",()=>ge(z),{onSuccess(){P(m({id:(0,E.OB)("Providers.data.loaded"),defaultMessage:"Providers have been loaded"}))},initialData:{}}),De=je||Ae,Se=(0,V.useMutation)(fe,{async onSuccess(){await O.invalidateQueries("get-providers"),z({type:"info",message:{id:(0,E.OB)("notification.success.submit")}}),x.current("didEditAuthenticationProvider"),F(!1),q(),R()},onError(){z({type:"warning",message:{id:"notification.error"}}),R(),F(!1)},refetchActive:!1}),H=(0,t.useMemo)(()=>he(N),[N]),ze=H.length,ue=(0,t.useMemo)(()=>{if(!p)return!1;const M=H.find(_=>_.name===p);return i()(M,"subdomain")},[H,p]),Ze=m({id:(0,E.OB)("HeaderNav.link.providers"),defaultMessage:"Providers"}),We=(0,t.useMemo)(()=>p==="email"?X.email:ue?X.providersWithSubdomain:X.providers,[p,ue]),q=()=>{L(M=>!M)},ce=M=>{$&&(C(M.name),q())},$e=async M=>{F(!0),Z(),x.current("willEditAuthenticationProvider");const _={...N,[p]:M};Se.mutate({providers:_})};return t.createElement(g.A,null,t.createElement(n.SettingsPageTitle,{name:Ze}),t.createElement(h.o,null,t.createElement(u.T,{title:m({id:(0,E.OB)("HeaderNav.link.providers"),defaultMessage:"Providers"})}),De||w?t.createElement(n.LoadingIndicatorPage,null):t.createElement(f.D,null,t.createElement(j.i,{colCount:3,rowCount:ze+1},t.createElement(D.h,null,t.createElement(A.Tr,null,t.createElement(b.Th,null,t.createElement(B.Z,{variant:"sigma",textColor:"neutral600"},m({id:"global.name",defaultMessage:"Name"}))),t.createElement(b.Th,null,t.createElement(B.Z,{variant:"sigma",textColor:"neutral600"},m({id:(0,E.OB)("Providers.status"),defaultMessage:"Status"}))),t.createElement(b.Th,null,t.createElement(B.Z,{variant:"sigma"},t.createElement(ee.T,null,m({id:"global.settings",defaultMessage:"Settings"})))))),t.createElement(K.p,null,H.map(M=>t.createElement(A.Tr,{key:M.name,...(0,n.onRowClick)({fn:()=>ce(M),condition:$})},t.createElement(b.Td,{width:"45%"},t.createElement(B.Z,{fontWeight:"semiBold",textColor:"neutral800"},M.name)),t.createElement(b.Td,{width:"65%"},t.createElement(B.Z,{textColor:M.enabled?"success600":"danger600","data-testid":`enable-${M.name}`},M.enabled?m({id:"global.enabled",defaultMessage:"Enabled"}):m({id:"global.disabled",defaultMessage:"Disabled"}))),t.createElement(b.Td,{...n.stopPropagation},$&&t.createElement(G.h,{onClick:()=>ce(M),noBorder:!0,icon:t.createElement(me.Z,null),label:"Edit"})))))))),t.createElement(Ue,{initialData:N[p],isOpen:U,isSubmiting:S,layout:We,headerBreadcrumbs:[m({id:(0,E.OB)("PopUpForm.header.edit.providers"),defaultMessage:"Edit Provider"}),r()(p)],onToggle:q,onSubmit:$e,providerToEditName:p}))},Fe=()=>t.createElement(n.CheckPagePermissions,{permissions:ie.Z.readProviders},t.createElement(de,null))},89031:(v,y,e)=>{"use strict";e.d(y,{YX:()=>s,Gc:()=>r,OB:()=>c.Z});var t=e(41609),l=e.n(t);const s=g=>Object.keys(g).reduce((h,u)=>{const f=g[u].controllers,j=Object.keys(f).reduce((D,A)=>(l()(f[A])||(D[A]=f[A]),D),{});return l()(j)||(h[u]={controllers:j}),h},{});var i=e(31498);const r=g=>`/${i.Z}/${g}`;var c=e(84757)},89881:(v,y,e)=>{var t=e(47816),l=e(99291),n=l(t);v.exports=n},69199:(v,y,e)=>{var t=e(89881),l=e(98612);function n(s,i){var d=-1,r=l(s)?Array(s.length):[];return t(s,function(c,g,h){r[++d]=i(c,g,h)}),r}v.exports=n},82689:(v,y,e)=>{var t=e(29932),l=e(97786),n=e(67206),s=e(69199),i=e(71131),d=e(7518),r=e(85022),c=e(6557),g=e(1469);function h(u,f,j){f.length?f=t(f,function(b){return g(b)?function(B){return l(B,b.length===1?b[0]:b)}:b}):f=[c];var D=-1;f=t(f,d(n));var A=s(u,function(b,B,ee){var K=t(f,function(G){return G(b)});return{criteria:K,index:++D,value:b}});return i(A,function(b,B){return r(b,B,j)})}v.exports=h},71131:v=>{function y(e,t){var l=e.length;for(e.sort(t);l--;)e[l]=e[l].value;return e}v.exports=y},26393:(v,y,e)=>{var t=e(33448);function l(n,s){if(n!==s){var i=n!==void 0,d=n===null,r=n===n,c=t(n),g=s!==void 0,h=s===null,u=s===s,f=t(s);if(!h&&!f&&!c&&n>s||c&&g&&u&&!h&&!f||d&&g&&u||!i&&u||!r)return 1;if(!d&&!c&&!f&&n<s||f&&i&&r&&!d&&!c||h&&i&&r||!g&&r||!u)return-1}return 0}v.exports=l},85022:(v,y,e)=>{var t=e(26393);function l(n,s,i){for(var d=-1,r=n.criteria,c=s.criteria,g=r.length,h=i.length;++d<g;){var u=t(r[d],c[d]);if(u){if(d>=h)return u;var f=i[d];return u*(f=="desc"?-1:1)}}return n.index-s.index}v.exports=l},99291:(v,y,e)=>{var t=e(98612);function l(n,s){return function(i,d){if(i==null)return i;if(!t(i))return n(i,d);for(var r=i.length,c=s?r:-1,g=Object(i);(s?c--:++c<r)&&d(g[c],c,g)!==!1;);return i}}v.exports=l},89734:(v,y,e)=>{var t=e(21078),l=e(82689),n=e(5976),s=e(16612),i=n(function(d,r){if(d==null)return[];var c=r.length;return c>1&&s(d,r[0],r[1])?r=[]:c>2&&s(r[0],r[1],r[2])&&(r=[r[0]]),l(d,t(r,1),[])});v.exports=i},2407:(v,y,e)=>{"use strict";e.d(y,{$:()=>g,O:()=>h});var t=e(85893),l=e(16405),n=e(54863),s=e(63237),i=e(11047),d=e(41580),r=e(75515);const c=(0,n.default)(i.k)`
  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
    path {
      fill: ${({theme:u})=>u.colors.neutral500};
    }
  }
  :last-of-type ${d.x} {
    display: none;
  }
  :last-of-type ${r.Z} {
    color: ${({theme:u})=>u.colors.neutral800};
    font-weight: ${({theme:u})=>u.fontWeights.bold};
  }
`,g=({children:u})=>(0,t.jsxs)(c,{inline:!0,as:"li",children:[(0,t.jsx)(r.Z,{variant:"pi",textColor:"neutral600",children:u}),(0,t.jsx)(d.x,{"aria-hidden":!0,paddingLeft:3,paddingRight:3,children:(0,t.jsx)(l.Z,{})})]});g.displayName="Crumb";const h=({children:u,label:f,...j})=>(0,t.jsxs)(i.k,{...j,children:[(0,t.jsx)(s.T,{children:f}),(0,t.jsx)("ol",{"aria-hidden":!0,children:u})]});h.displayName="Breadcrumbs"}}]);
